---
title: "E-cig craving project"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


### load the data set 
```{r}
load("D:/DATA SCIENCE PROJECT/E-cig-craving-Project/data/36498-1001-Data.rda")
load("D:/DATA SCIENCE PROJECT/E-cig-craving-Project/data/36498-1002-Data.rda")
load("D:/DATA SCIENCE PROJECT/E-cig-craving-Project/data/36498-3001-Data.rda")
```

```{r}
library(tidyverse)
library(ggplot2)
wave1_adult <- da36498.1001
wave1_youth_parent <- da36498.1002

#select variables and data cleaning 

chosen_variable_wave1<- wave1_adult %>%
  select(CASEID, PERSONID, 
         R01_AC1002, ##Have you ever smoked a cigarette, even one or two puffs?
         R01_AC1003, ##Do you now smoke cigarettes . . .
         R01_AC1004, ##In the past 30 days, have you smoked a cigarette, even one or two puffs?
         R01_AC9050, ##How harmful do you think cigarettes are to health?
         R01_AE1001, ## Have you ever seen or heard of an electronic cigarette or e-cigarette before this study?
         R01_AE1002, ##Have you ever used an e-cigarette, such as NJOY, Blu, or Smoking Everywhere, even one or two times?
         R01_AE1003, ##Do you now use e-cigarettes . . .
         R01_AE1004, ##In the past 30 days, have you used an e-cigarette, even one or two times?
         R01_AE1022, ##On how many of the past 30 days did you use [e-cigarette / e-cigarette cartridges]?
         R01_AE1008, ##When you first started using e-cigarettes, did you use cartridges or disposable e-cigarettes flavored to taste like menthol, mint, clove, spice, candy, fruit, chocolate, alcohol (such as wine or cognac), or other sweets?
         R01_AE1090, ##Do you own an e-cigarette?
         R01_AE1099, ##Is using e-cigarettes less harmful, about the same, or more harmful than smoking cigarettes?
         R01_AE1100, ##Have you ever used e-cigarettes fairly regularly?
         R01R_A_RACECAT3_IMP, ##Race category
         R01R_A_BMI, ## BMI 
         R01R_A_SEXORIENT2,## Sexual Orientation
         R01R_A_AC1006, ##Age range when first smoked part or all of a cigarette
         R01R_A_AE1006, ##Age range when first time used an e-cigarette, even one or two times
         R01R_A_AE1007, ##Age range when first started using e-cigarettes fairly regularly
         R01R_A_AE1020, ## Age range when first started using e-cigarettes every day
         R01R_A_AM0018, ## Highest grade or level of school completed
         R01R_A_AM0030, ## Total household income in the past 12 months
         R01_AN0015, ## Has strong cravings to use / smoke [tobacco products / specific product]
         R01_AN0015E, ## Has strong cravings to use e-cigarettes (for dual and poly users of tobacco who use e-cigarettes)
         R01_AN0025, ##Please rate your level of agreement for each statement using the following scale: 1= not true of me at all to 5=extremely true of me.  The following statements are about the use of tobacco and nicotine in general.  I frequently crave [ND FILL2].
         R01_AN0025E, ##Please rate your level of agreement for each statement using the following scale: 1= not true of me at all to 5=extremely true of me.  I frequently crave e-cigarettes.
         R01_AN0215, ## Thinking back to [the time you tried to quit / the last time you tried to quit / when you quit] in the past 12 months, did you use any of the following to help you: counseling, a telephone help line or quit line, books, pamphlets, videos, a quit tobacco clinic, class, or support group, or an internet or web-based program?
         R01_AN0215E, ## Thinking back to [the time you tried to quit / the last time you tried to quit / when you quit] using e-cigarettes in the past 12 months, did you use any of the following to help you: counseling, a telephone help line or quit line, books, pamphlets, videos, a quit tobacco clinic, class, or support group, or an internet or web-based program?
         R01_AN0250, ## To what extent, if at all, do you believe nicotine to be the main substance in tobacco that makes people want to use tobacco products?
         R01_AR0110, ## In the past 30 days, how often, if at all, have you noticed the health warnings on packages of e-cigarettes?
         R01_AR0142, ## In the past 12 months, how often have you thought about the chemicals contained in tobacco products?
         R01_AX0005, ## How would you describe your overall opinion of using tobacco?
         R01_AX0090, ##In general, how would you rate your physical health?
         R01_AX0091, ##In general, how would you rate your mental health, which includes stress, depression, and problems with emotions?
         R01_AX0004,## In the past 30 days, how often did you think about the harm your tobacco use might be doing to you?
         R01_AX0064_01, ## Work setting: Indoors Is your main work area indoors, outdoors, or in a vehicle? Choose all that apply
         R01_AX0064_02, ## Work setting: Outdoors Is your main work area indoors, outdoors, or in a vehicle? Choose all that apply
         R01_AX0064_03, ## Work setting: Vehicle Is your main work area indoors, outdoors, or in a vehicle? Choose all that apply
         R01_AX0065, ## How recently someone smoked around you while at work
         R01_AR0144, ## Lived with a regular smoker who smoked inside your home during childhood
         R01_AX0104,## Extent to which using / past use of tobacco products damaged your health
         R01_AX0105, ## Extent to which you are worried that using / your past use of tobacco products will damage your health in the future
         R01R_A_RACECAT3,## Race category
         R01R_A_CUR_ESTD_CIGS, ## Has ever smoked a cigarette, has smoked more than 100 cigarettes in lifetime, and currently smokes every day or some days.
         R01R_A_EDY_CIGS, ## Has ever used an cigarette, has used fairly regularly, and uses every day.
         R01R_A_SDY_CIGS, ## Has ever used an cigarette, has used fairly regularly, and uses some days
         R01R_A_P30D_CIGS, ## Has ever used an cigarette and has used at least once in the past 30 days
         R01R_A_CUR_ESTD_ECIG, ## Has ever used an e-cigarette, has used fairly regularly, and uses every day or some days.
         R01R_A_EDY_ECIG, ## Has ever used an e-cigarette, has used fairly regularly, and uses every day.
         R01R_A_SDY_ECIG, ## Has ever used an e-cigarette, has used fairly regularly, and uses some days
         R01R_A_P30D_ECIG, ## Has ever used an e-cigarette and has used at least once in the past 30 days
         R01R_A_AGECAT7_IMP ## Imputed age range.
         ) %>%
  mutate(current_established_ecig_user = if_else(R01R_A_CUR_ESTD_ECIG == "(1) 1 = Yes", 1,0 )) %>%
  mutate(current_everyday_ecig_user = if_else(R01R_A_EDY_ECIG == "(1) 1 = Yes", 1,0 )) %>%
  mutate(current_someday_ecig_user = if_else(R01R_A_SDY_ECIG == "(1) 1 = Yes", 1,0 )) %>%
  mutate(current_past30day_ecig_user = if_else(R01R_A_P30D_ECIG == "(1) 1 = Yes", 1,0 ))%>%
  mutate(current_established_cig_user = if_else(R01R_A_CUR_ESTD_CIGS == "(1) 1 = Yes", 1,0 )) %>%
  mutate(current_everyday_cig_user = if_else(R01R_A_EDY_CIGS == "(1) 1 = Yes", 1,0 )) %>%
  mutate(current_someday_cig_user = if_else(R01R_A_SDY_CIGS == "(1) 1 = Yes", 1,0 )) %>%
  mutate(current_past30day_cig_user = if_else(R01R_A_P30D_CIGS == "(1) 1 = Yes", 1,0 ))%>%
  mutate(Race= case_when(
    R01R_A_RACECAT3 == "(1) 1 = White alone"~"White",
    R01R_A_RACECAT3 == "(2) 2 = Black alone"~ "Black",
    R01R_A_RACECAT3 == "(3) 3 = Other"~ "other"
  )) %>%
  mutate(ecig_craving = case_when(
    R01_AN0025E == "(1) 1 = Not true of me at all"~ "1",
    R01_AN0025E == "(2) 2 = 2 on a scale of 1 to 5"~ "2",
    R01_AN0025E == "(3) 3 = 3 on a scale of 1 to 5"~ "3",
    R01_AN0025E == "(4) 4 = 4 on a scale of 1 to 5"~ "4",
    R01_AN0025E == "(5) 5 = Extremely true of me"~ "5"
    ))
 

#race distribution   
chosen_variable_wave1 %>%
  ggplot()+
  geom_bar(aes(x = R01R_A_RACECAT3))

chosen_variable_wave1 %>%
  ggplot(aes(R01R_A_RACECAT3)) +
  geom_bar(aes(y = (..count..)/sum(..count..)))+
  scale_y_continuous(labels=scales::percent) +
          ylab("relative frequencies")

## race and e-cig smoking 
chosen_variable_wave1 %>%
  ggplot()+
  geom_col(aes(x = R01R_A_RACECAT3, y = current_established_ecig_user))

chosen_variable_wave1 %>%
  ggplot()+
  geom_col(aes(x = R01R_A_RACECAT3, y = current_everyday_ecig_user))

chosen_variable_wave1 %>%
  ggplot()+
  geom_col(aes(x = R01R_A_RACECAT3, y = current_someday_ecig_user))

chosen_variable_wave1 %>%
  ggplot()+
  geom_col(aes(x = R01R_A_RACECAT3, y = current_past30day_ecig_user))

## smoking cigarettes and smoking e-cigarettes   
chosen_variable_wave1 %>%
  ggplot()+
  geom_col(aes(x = R01_AC1003, y = current_established_ecig_user))

chosen_variable_wave1 %>%
  ggplot()+
  geom_col(aes(x = R01_AC1003, y = current_everyday_ecig_user))

chosen_variable_wave1 %>%
  ggplot()+
  geom_col(aes(x = R01_AC1003, y = current_someday_ecig_user))

chosen_variable_wave1 %>%
  ggplot()+
  geom_col(aes(x = R01_AC1003, y = current_past30day_ecig_user))

chosen_variable_wave1 %>%
  ggplot()+
  geom_col(aes(x = current_established_ecig_user, y = current_established_cig_user))

chosen_variable_wave1 %>%
  ggplot()+
  geom_col(aes(x = current_everyday_ecig_user, y = current_everyday_cig_user))

chosen_variable_wave1 %>%
  ggplot()+
  geom_col(aes(x = current_someday_ecig_user, y = current_someday_cig_user))


chosen_variable_wave1 %>%
  ggplot()+
  geom_col(aes(x = R01_AC1003, y = R01_AN0025E))

#Craving and established e-cig smokers
chosen_variable_wave1 %>%
  ggplot()+
  geom_col(aes(x =ecig_craving , y= current_established_ecig_user))

chosen_variable_wave1 %>%
  ggplot()+
  geom_bar(aes(x =ecig_craving))

df1<- chosen_variable_wave1 %>%
  select( CASEID, ecig_craving, current_established_ecig_user)


df1 %>%
  summarise(ecig_craving)


wave2 <- da36498.2001

chosen_variable_wave2<- wave2 %>%
   select(CASEID, PERSONID, 
R02_AC1002_12M,
R02_AC1003,
R02_AC1004,
R02_AC9050,
R02_AE1008,
R02_AE1004,
R02_AE1022,
R02_AE1090,
R02_AE1099,
R02_AE1100,
R02R_A_AC1006,
R02R_A_AE1006,
R02R_A_AE1007,
R02R_A_AE1020,
R02R_A_AM0018,
R02R_A_AM0030,
R02_AN0015,
R02_AN0015E,
R02_AN0025,
R02_AN0025E,
R02_AN0215,
R02_AN0215E,
R02_AR0110,
R02_AR0142,
R02_AX0004,
R02_AX0005,
R02_AX0090,
R02_AX0091,
R02_AN0250,
R02_AX0064_01,
R02_AX0064_02,
R02_AX0064_03,
R02_AX0065,
R02_AR0144,
R02_AX0104,
R02_AX0105,
R02R_A_RACECAT3_IMP, 
R02R_A_BMI,
R02R_A_SEXORIENT2,
R02R_A_RACECAT3,
R02R_A_CUR_ESTD_ECIG,
R02R_A_EDY_ECIG,
R02R_A_SDY_ECIG, 
R02R_A_P30D_ECIG,
R02R_A_AGECAT7_IMP) %>%
  mutate(current_established_ecig_user = if_else(R02R_A_CUR_ESTD_ECIG == "(1) 1 = Yes", 1,0 )) %>%
  mutate(current_everyday_ecig_user = if_else(R02R_A_EDY_ECIG == "(1) 1 = Yes", 1,0 )) %>%
  mutate(current_someday_ecig_user = if_else(R02R_A_SDY_ECIG == "(1) 1 = Yes", 1,0 )) %>%
   mutate(current_past30day_ecig_user = if_else(R02R_A_P30D_ECIG == "(1) 1 = Yes", 1,0 )) 



```

